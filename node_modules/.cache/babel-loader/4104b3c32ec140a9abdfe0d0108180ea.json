{"ast":null,"code":"var _jsxFileName = \"/Users/rachel/Desktop/A4-How-does-Coronavirus-spreadirus-spread/my-app/src/LineChart.js\";\nimport React, { Component } from 'react';\nimport * as d3 from \"d3\";\nconst width = 960;\nconst height = 500;\nconst margin = {\n  top: 50,\n  right: 50,\n  bottom: 100,\n  left: 50\n};\n\nclass LineChart extends Component {\n  componentDidMount() {\n    this.drawChart(this.props.data);\n  }\n\n  componentDidUpdate() {\n    this.update(this.props.data, this.props.threshold, this.props.selected);\n  }\n\n  drawChart(data) {\n    // ------- scale ---------//\n    // let new_data = data.filter(function(d) {return d.date <\n    var startDate = data.date[0],\n        endDate = data.date[data.date.length - 1];\n    var maxi = d3.max(data.series, s => d3.max(s.positive.map(function (d) {\n      if (d != \"undefined\") {\n        return d;\n      } else {\n        return -1;\n      }\n    })));\n    console.log(d3.max(data.series[0].positive));\n    console.log(maxi);\n    var xScale = d3.scaleTime().domain([startDate, endDate]).range([margin.left, width - margin.right]);\n    var yScale = d3.scaleLinear() // d3.max(data, d => d.positive)\n    .domain([0, maxi]).nice().range([height - margin.bottom, margin.top]); // --------- axis --------//\n\n    const xAxis = d3.axisBottom().ticks(d3.timeDay.every(1)).tickFormat(d3.timeFormat('%m/%d')).scale(xScale);\n    const yAxis = d3.axisLeft().ticks(10).scale(yScale); // ------- draw --------//\n\n    this.svg = d3.select(this.refs.chart).append(\"svg\").attr('width', width).attr('height', height);\n    this.svg.append(\"g\").attr(\"transform\", `translate(0,${height - margin.bottom})`).call(xAxis);\n    this.svg.append(\"g\").attr(\"transform\", `translate(${margin.left},0)`).call(yAxis);\n    this.chart = this.svg.append(\"g\");\n  }\n\n  update(data, threshold, selected) {\n    // let new_data = data.filter(function(d) {return d.date <\n    console.log(selected);\n    var index = data.date.findIndex(function (d) {\n      return d.getDate() === threshold.getDate();\n    });\n    var new_data = data.series.filter(d => {\n      return selected.includes(d.name);\n    });\n    console.log(new_data.length);\n    new_data = new_data.map(d => {\n      return {\n        name: d.name,\n        positive: d.positive.slice(0, index)\n      };\n    });\n    console.log(new_data);\n    var startDate = data.date[0],\n        endDate = data.date[data.date.length - 1];\n    var maxi = d3.max(data.series, s => d3.max(s.positive.map(function (d) {\n      if (d != \"undefined\") {\n        return d;\n      } else {\n        return -1;\n      }\n    })));\n    var xScale = d3.scaleTime().domain([startDate, endDate]).range([margin.left, width - margin.right]);\n    var yScale = d3.scaleLinear().domain([0, maxi]).nice().range([height - margin.bottom, margin.top]);\n    var color = d3.scaleOrdinal(d3.schemeTableau10).domain(new_data.map(d => d.name));\n    var line = d3.line().defined(d => d != \"undefined\").x((d, i) => xScale(data.date[i])).y(d => yScale(d));\n    var names = new_data.map(d => d.name);\n    var divToolTip = this.svg.append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 1e-6);\n    this.chart.selectAll(\"path\").data(new_data).join(\"path\").attr(\"stroke-width\", 2).attr(\"stroke\", d => color(d.name)).attr(\"fill\", \"none\").attr(\"d\", d => line(d.positive));\n    this.chart.selectAll(\"text\").data(new_data).join(\"text\").attr(\"x\", xScale(endDate)) // space legend\n    .attr(\"y\", (d, i) => margin.top + i * 15).attr(\"class\", \"legend\") // style the legend\n    .style(\"fill\", d => color(d.name)).text(d => d.name);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      ref: \"chart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 20\n      }\n    });\n  }\n\n}\n\nexport default LineChart;","map":{"version":3,"sources":["/Users/rachel/Desktop/A4-How-does-Coronavirus-spreadirus-spread/my-app/src/LineChart.js"],"names":["React","Component","d3","width","height","margin","top","right","bottom","left","LineChart","componentDidMount","drawChart","props","data","componentDidUpdate","update","threshold","selected","startDate","date","endDate","length","maxi","max","series","s","positive","map","d","console","log","xScale","scaleTime","domain","range","yScale","scaleLinear","nice","xAxis","axisBottom","ticks","timeDay","every","tickFormat","timeFormat","scale","yAxis","axisLeft","svg","select","refs","chart","append","attr","call","index","findIndex","getDate","new_data","filter","includes","name","slice","color","scaleOrdinal","schemeTableau10","line","defined","x","i","y","names","divToolTip","style","selectAll","join","text","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport * as d3 from \"d3\"\n\nconst width = 960;\nconst height = 500;\nconst margin = {top: 50, right: 50, bottom: 100, left:50};\n\nclass LineChart extends Component {\n\n  componentDidMount() {\n    this.drawChart(this.props.data)\n  }\n\n  componentDidUpdate(){\n    this.update(this.props.data, this.props.threshold, this.props.selected)\n  }\n\n  drawChart(data) {\n    // ------- scale ---------//\n    // let new_data = data.filter(function(d) {return d.date <\n    var startDate = data.date[0],\n        endDate = data.date[data.date.length-1];\n\n    var maxi = d3.max(data.series, s => d3.max(s.positive.map(\n      function(d) {\n            if (d != \"undefined\") {return d}\n            else { return -1}\n      })))\n    console.log(d3.max(data.series[0].positive))\n    console.log(maxi)\n\n    var xScale = d3.scaleTime()\n      .domain([startDate, endDate])\n      .range([margin.left, width - margin.right]);\n\n    var yScale = d3.scaleLinear()\n      // d3.max(data, d => d.positive)\n      .domain ([0, maxi]).nice()\n      .range([height - margin.bottom, margin.top])\n\n    // --------- axis --------//\n    const xAxis = d3.axisBottom()\n      .ticks(d3.timeDay.every(1))\n      .tickFormat(d3.timeFormat('%m/%d'))\n      .scale(xScale);\n\n    const yAxis = d3.axisLeft()\n      .ticks(10)\n      .scale(yScale);\n\n    // ------- draw --------//\n    this.svg = d3.select(this.refs.chart)\n      .append(\"svg\")\n      .attr('width', width )\n      .attr('height', height )\n\n    this.svg.append(\"g\")\n      .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n      .call(xAxis);\n\n    this.svg.append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},0)`)\n      .call(yAxis);\n\n    this.chart = this.svg.append(\"g\")\n\n\n    }\n\n    update(data, threshold, selected){\n      // let new_data = data.filter(function(d) {return d.date <\n      console.log(selected)\n      var index = data.date.findIndex(function(d) {return d.getDate() === threshold.getDate()});\n      var new_data = data.series.filter(d => {return selected.includes(d.name)})\n      console.log(new_data.length)\n\n      new_data = new_data.map(d => { return {\n        name: d.name,\n        positive: d.positive.slice(0,index)\n        }\n      })\n      console.log(new_data)\n\n      var startDate = data.date[0],\n          endDate = data.date[data.date.length-1];\n\n      var maxi = d3.max(data.series, s => d3.max(s.positive.map(\n        function(d) {\n              if (d != \"undefined\") {return d}\n              else { return -1}\n        })))\n\n      var xScale = d3.scaleTime()\n        .domain([startDate, endDate])\n        .range([margin.left, width - margin.right]);\n\n      var yScale = d3.scaleLinear()\n        .domain ([0, maxi]).nice()\n        .range([height - margin.bottom, margin.top])\n\n\n      var color = d3.scaleOrdinal(d3.schemeTableau10).domain(new_data.map(d => d.name));\n\n      var line = d3.line()\n        .defined(d => d != \"undefined\")\n        .x((d,i) => xScale(data.date[i]))\n        .y(d => yScale(d))\n\n      var names = new_data.map(d=> d.name);\n\n      var divToolTip = this.svg.append(\"div\")\n                        .attr(\"class\", \"tooltip\")\n                        .style(\"opacity\", 1e-6);\n\n      this.chart.selectAll(\"path\")\n        .data(new_data)\n          .join(\"path\")\n            .attr(\"stroke-width\", 2)\n            .attr(\"stroke\", (d)=> color(d.name))\n            .attr(\"fill\", \"none\")\n            .attr(\"d\", d=>line(d.positive))\n\n      this.chart.selectAll(\"text\")\n        .data(new_data)\n          .join(\"text\")\n          .attr(\"x\", xScale(endDate))  // space legend\n          .attr(\"y\", (d,i) => margin.top + i*15)\n          .attr(\"class\", \"legend\")    // style the legend\n          .style(\"fill\", (d) => color(d.name))\n          .text(d => d.name);\n        }\n\n\n  render() {return <div ref=\"chart\"></div>}\n}\n\n\nexport default LineChart;\n"]},"metadata":{},"sourceType":"module"}