{"ast":null,"code":"import { min, max, scan } from 'd3-array';\nimport { axisTop, axisRight, axisBottom, axisLeft } from 'd3-axis';\nimport { dispatch } from 'd3-dispatch';\nimport { drag } from 'd3-drag';\nimport { easeQuadOut } from 'd3-ease';\nimport { scaleLinear, scaleTime } from 'd3-scale';\nimport { event, select } from 'd3-selection';\nimport 'd3-transition';\nvar UPDATE_DURATION = 200;\nvar SLIDER_END_PADDING = 8;\nvar KEYBOARD_NUMBER_STEPS = 100;\nvar top = 1;\nvar right = 2;\nvar bottom = 3;\nvar left = 4;\n\nfunction translateX(x) {\n  return 'translate(' + x + ',0)';\n}\n\nfunction translateY(y) {\n  return 'translate(0,' + y + ')';\n}\n\nfunction slider(orientation, scale) {\n  scale = typeof scale !== 'undefined' ? scale : null;\n  var value = [0];\n  var defaultValue = [0];\n  var domain = [0, 10];\n  var width = 100;\n  var height = 100;\n  var displayValue = true;\n  var handle = 'M-5.5,-5.5v10l6,5.5l6,-5.5v-10z';\n  var step = null;\n  var tickValues = null;\n  var marks = null;\n  var tickFormat = null;\n  var ticks = null;\n  var displayFormat = null;\n  var fill = null;\n  var listeners = dispatch('onchange', 'start', 'end', 'drag');\n  var selection = null;\n  var identityClamped = null;\n  var handleIndex = null;\n  var k = orientation === top || orientation === left ? -1 : 1;\n  var j = orientation === left || orientation === right ? -1 : 1;\n  var x = orientation === left || orientation === right ? 'y' : 'x';\n  var y = orientation === left || orientation === right ? 'x' : 'y';\n  var transformAlong = orientation === top || orientation === bottom ? translateX : translateY;\n  var transformAcross = orientation === top || orientation === bottom ? translateY : translateX;\n  var axisFunction = null;\n\n  switch (orientation) {\n    case top:\n      axisFunction = axisTop;\n      break;\n\n    case right:\n      axisFunction = axisRight;\n      break;\n\n    case bottom:\n      axisFunction = axisBottom;\n      break;\n\n    case left:\n      axisFunction = axisLeft;\n      break;\n  }\n\n  var handleSelection = null;\n  var fillSelection = null;\n  var textSelection = null;\n\n  if (scale) {\n    domain = [min(scale.domain()), max(scale.domain())];\n\n    if (orientation === top || orientation === bottom) {\n      width = max(scale.range()) - min(scale.range());\n    } else {\n      height = max(scale.range()) - min(scale.range());\n    }\n\n    scale = scale.clamp(true);\n  }\n\n  function slider(context) {\n    selection = context.selection ? context.selection() : context;\n\n    if (scale) {\n      scale = scale.range([min(scale.range()), min(scale.range()) + (orientation === top || orientation === bottom ? width : height)]);\n    } else {\n      scale = domain[0] instanceof Date ? scaleTime() : scaleLinear();\n      scale = scale.domain(domain).range(orientation === top || orientation === bottom ? [0, width] : [height, 0]).clamp(true);\n    }\n\n    identityClamped = scaleLinear().range(scale.range()).domain(scale.range()).clamp(true); // Ensure value is valid\n\n    value = value.map(function (d) {\n      return scaleLinear().range(domain).domain(domain).clamp(true)(d);\n    });\n    tickFormat = tickFormat || scale.tickFormat();\n    displayFormat = displayFormat || tickFormat || scale.tickFormat();\n    var axis = selection.selectAll('.axis').data([null]);\n    axis.enter().append('g').attr('transform', transformAcross(k * 7)).attr('class', 'axis');\n    var sliderSelection = selection.selectAll('.slider').data([null]);\n    var sliderEnter = sliderSelection.enter().append('g').attr('class', 'slider').attr('cursor', orientation === top || orientation === bottom ? 'ew-resize' : 'ns-resize').call(drag().on('start', dragstarted).on('drag', dragged).on('end', dragended));\n    sliderEnter.append('line').attr('class', 'track').attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING).attr('stroke', '#bbb').attr('stroke-width', 6).attr('stroke-linecap', 'round');\n    sliderEnter.append('line').attr('class', 'track-inset').attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING).attr('stroke', '#eee').attr('stroke-width', 4).attr('stroke-linecap', 'round');\n\n    if (fill) {\n      sliderEnter.append('line').attr('class', 'track-fill').attr(x + '1', value.length === 1 ? scale.range()[0] - j * SLIDER_END_PADDING : scale(value[0])).attr('stroke', fill).attr('stroke-width', 4).attr('stroke-linecap', 'round');\n    }\n\n    sliderEnter.append('line').attr('class', 'track-overlay').attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING).attr('stroke', 'transparent').attr('stroke-width', 40).attr('stroke-linecap', 'round').merge(sliderSelection.select('.track-overlay'));\n    handleSelection = sliderEnter.selectAll('.parameter-value').data(value);\n    var handleEnter = handleSelection.enter().append('g').attr('class', 'parameter-value').attr('transform', function (d) {\n      return transformAlong(scale(d));\n    }).attr('font-family', 'sans-serif').attr('text-anchor', orientation === right ? 'start' : orientation === left ? 'end' : 'middle');\n    handleEnter.append('path').attr('transform', 'rotate(' + (orientation + 1) * 90 + ')').attr('d', handle).attr('class', 'handle').attr('aria-label', 'handle').attr('aria-valuemax', domain[1]).attr('aria-valuemin', domain[0]).attr('aria-valuenow', value).attr('aria-orientation', orientation === left || orientation === right ? 'vertical' : 'horizontal').attr('focusable', 'true').attr('tabindex', 0).attr('fill', 'white').attr('stroke', '#777').on('keydown', function (d, i) {\n      var change = step || (domain[1] - domain[0]) / KEYBOARD_NUMBER_STEPS; // TODO: Don't need to loop over value because we know which element needs to change\n\n      function newValue(adjustedValue) {\n        return value.map(function (d, j) {\n          if (value.length === 2) {\n            return j === i ? i === 0 ? Math.min(adjustedValue, alignedValue(value[1])) : Math.max(adjustedValue, alignedValue(value[0])) : d;\n          } else {\n            return j === i ? adjustedValue : d;\n          }\n        });\n      }\n\n      switch (event.key) {\n        case 'ArrowLeft':\n        case 'ArrowDown':\n          slider.value(newValue(+value[i] - change));\n          event.preventDefault();\n          break;\n\n        case 'PageDown':\n          slider.value(newValue(+value[i] - 2 * change));\n          event.preventDefault();\n          break;\n\n        case 'ArrowRight':\n        case 'ArrowUp':\n          slider.value(newValue(+value[i] + change));\n          event.preventDefault();\n          break;\n\n        case 'PageUp':\n          slider.value(newValue(+value[i] + 2 * change));\n          event.preventDefault();\n          break;\n\n        case 'Home':\n          slider.value(newValue(domain[0]));\n          event.preventDefault();\n          break;\n\n        case 'End':\n          slider.value(newValue(domain[1]));\n          event.preventDefault();\n          break;\n      }\n    });\n\n    if (displayValue && value.length === 1) {\n      handleEnter.append('text').attr('font-size', 10) // TODO: Remove coupling to font-size in d3-axis\n      .attr(y, k * 27).attr('dy', orientation === top ? '0em' : orientation === bottom ? '.71em' : '.32em').text(tickFormat(value[0]));\n    }\n\n    context.select('.track').attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n    context.select('.track-inset').attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n\n    if (fill) {\n      context.select('.track-fill').attr(x + '2', value.length === 1 ? scale(value[0]) : scale(value[1]));\n    }\n\n    context.select('.track-overlay').attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n    context.select('.axis').call(axisFunction(scale).tickFormat(tickFormat).ticks(ticks).tickValues(tickValues)); // https://bl.ocks.org/mbostock/4323929\n\n    selection.select('.axis').select('.domain').remove();\n    context.select('.axis').attr('transform', transformAcross(k * 7));\n    context.selectAll('.axis text').attr('fill', '#aaa').attr(y, k * 20).attr('dy', orientation === top ? '0em' : orientation === bottom ? '.71em' : '.32em').attr('text-anchor', orientation === right ? 'start' : orientation === left ? 'end' : 'middle');\n    context.selectAll('.axis line').attr('stroke', '#aaa');\n    context.selectAll('.parameter-value').attr('transform', function (d) {\n      return transformAlong(scale(d));\n    });\n    fadeTickText();\n\n    function computeDragNewValue(pos) {\n      var adjustedValue = alignedValue(scale.invert(pos));\n      return value.map(function (d, i) {\n        if (value.length === 2) {\n          return i === handleIndex ? handleIndex === 0 ? Math.min(adjustedValue, alignedValue(value[1])) : Math.max(adjustedValue, alignedValue(value[0])) : d;\n        } else {\n          return i === handleIndex ? adjustedValue : d;\n        }\n      });\n    }\n\n    function dragstarted() {\n      select(this).classed('active', true);\n      var pos = identityClamped(orientation === bottom || orientation === top ? event.x : event.y); // Handle cases where both handles are at the same end of the slider\n\n      if (value[0] === domain[0] && value[1] === domain[0]) {\n        handleIndex = 1;\n      } else if (value[0] === domain[1] && value[1] === domain[1]) {\n        handleIndex = 0;\n      } else {\n        handleIndex = scan(value.map(function (d) {\n          return Math.abs(d - alignedValue(scale.invert(pos)));\n        }));\n      }\n\n      var newValue = value.map(function (d, i) {\n        return i === handleIndex ? alignedValue(scale.invert(pos)) : d;\n      });\n      updateHandle(newValue);\n      listeners.call('start', sliderSelection, newValue.length === 1 ? newValue[0] : newValue);\n      updateValue(newValue, true);\n    }\n\n    function dragged() {\n      var pos = identityClamped(orientation === bottom || orientation === top ? event.x : event.y);\n      var newValue = computeDragNewValue(pos);\n      updateHandle(newValue);\n      listeners.call('drag', sliderSelection, newValue.length === 1 ? newValue[0] : newValue);\n      updateValue(newValue, true);\n    }\n\n    function dragended() {\n      select(this).classed('active', false);\n      var pos = identityClamped(orientation === bottom || orientation === top ? event.x : event.y);\n      var newValue = computeDragNewValue(pos);\n      updateHandle(newValue);\n      listeners.call('end', sliderSelection, newValue.length === 1 ? newValue[0] : newValue);\n      updateValue(newValue, true);\n      handleIndex = null;\n    }\n\n    textSelection = selection.select('.parameter-value text');\n    fillSelection = selection.select('.track-fill');\n  }\n\n  function fadeTickText() {\n    if (selection) {\n      if (displayValue && value.length === 1) {\n        var distances = [];\n        selection.selectAll('.axis .tick').each(function (d) {\n          distances.push(Math.abs(d - value[0]));\n        });\n        var index = scan(distances);\n        selection.selectAll('.axis .tick text').attr('opacity', function (d, i) {\n          return i === index ? 0 : 1;\n        });\n      }\n    }\n  }\n\n  function alignedValue(newValue) {\n    if (step) {\n      var valueModStep = (newValue - domain[0]) % step;\n      var alignValue = newValue - valueModStep;\n\n      if (valueModStep * 2 > step) {\n        alignValue += step;\n      }\n\n      return newValue instanceof Date ? new Date(alignValue) : alignValue;\n    }\n\n    if (marks) {\n      var index = scan(marks.map(function (d) {\n        return Math.abs(newValue - d);\n      }));\n      return marks[index];\n    }\n\n    return newValue;\n  }\n\n  function updateValue(newValue, notifyListener) {\n    if (value[0] !== newValue[0] || value.length > 1 && value[1] !== newValue[1]) {\n      value = newValue;\n\n      if (notifyListener) {\n        listeners.call('onchange', slider, newValue.length === 1 ? newValue[0] : newValue);\n      }\n\n      fadeTickText();\n    }\n  }\n\n  function updateHandle(newValue, animate) {\n    if (selection) {\n      animate = typeof animate !== 'undefined' ? animate : false;\n\n      if (animate) {\n        selection.selectAll('.parameter-value').data(newValue).transition().ease(easeQuadOut).duration(UPDATE_DURATION).attr('transform', function (d) {\n          return transformAlong(scale(d));\n        }).select('.handle').attr('aria-valuenow', function (d) {\n          return d;\n        });\n\n        if (fill) {\n          fillSelection.transition().ease(easeQuadOut).duration(UPDATE_DURATION).attr(x + '1', value.length === 1 ? scale.range()[0] - k * SLIDER_END_PADDING : scale(newValue[0])).attr(x + '2', value.length === 1 ? scale(newValue[0]) : scale(newValue[1]));\n        }\n      } else {\n        selection.selectAll('.parameter-value').data(newValue).attr('transform', function (d) {\n          return transformAlong(scale(d));\n        }).select('.handle').attr('aria-valuenow', function (d) {\n          return d;\n        });\n\n        if (fill) {\n          fillSelection.attr(x + '1', value.length === 1 ? scale.range()[0] - k * SLIDER_END_PADDING : scale(newValue[0])).attr(x + '2', value.length === 1 ? scale(newValue[0]) : scale(newValue[1]));\n        }\n      }\n\n      if (displayValue) {\n        textSelection.text(displayFormat(newValue[0]));\n      }\n    }\n  }\n\n  slider.min = function (_) {\n    if (!arguments.length) return domain[0];\n    domain[0] = _;\n    return slider;\n  };\n\n  slider.max = function (_) {\n    if (!arguments.length) return domain[1];\n    domain[1] = _;\n    return slider;\n  };\n\n  slider.domain = function (_) {\n    if (!arguments.length) return domain;\n    domain = _;\n    return slider;\n  };\n\n  slider.width = function (_) {\n    if (!arguments.length) return width;\n    width = _;\n    return slider;\n  };\n\n  slider.height = function (_) {\n    if (!arguments.length) return height;\n    height = _;\n    return slider;\n  };\n\n  slider.tickFormat = function (_) {\n    if (!arguments.length) return tickFormat;\n    tickFormat = _;\n    return slider;\n  };\n\n  slider.displayFormat = function (_) {\n    if (!arguments.length) return displayFormat;\n    displayFormat = _;\n    return slider;\n  };\n\n  slider.ticks = function (_) {\n    if (!arguments.length) return ticks;\n    ticks = _;\n    return slider;\n  };\n\n  slider.value = function (_) {\n    if (!arguments.length) {\n      if (value.length === 1) {\n        return value[0];\n      }\n\n      return value;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n    toArray.sort(function (a, b) {\n      return a - b;\n    });\n    var pos = toArray.map(scale).map(identityClamped);\n    var newValue = pos.map(scale.invert).map(alignedValue);\n    updateHandle(newValue, true);\n    updateValue(newValue, true);\n    return slider;\n  };\n\n  slider.silentValue = function (_) {\n    if (!arguments.length) {\n      if (value.length === 1) {\n        return value[0];\n      }\n\n      return value;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n    toArray.sort(function (a, b) {\n      return a - b;\n    });\n    var pos = toArray.map(scale).map(identityClamped);\n    var newValue = pos.map(scale.invert).map(alignedValue);\n    updateHandle(newValue, false);\n    updateValue(newValue, false);\n    return slider;\n  };\n\n  slider.default = function (_) {\n    if (!arguments.length) {\n      if (defaultValue.length === 1) {\n        return defaultValue[0];\n      }\n\n      return defaultValue;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n    toArray.sort(function (a, b) {\n      return a - b;\n    });\n    defaultValue = toArray;\n    value = toArray;\n    return slider;\n  };\n\n  slider.step = function (_) {\n    if (!arguments.length) return step;\n    step = _;\n    return slider;\n  };\n\n  slider.tickValues = function (_) {\n    if (!arguments.length) return tickValues;\n    tickValues = _;\n    return slider;\n  };\n\n  slider.marks = function (_) {\n    if (!arguments.length) return marks;\n    marks = _;\n    return slider;\n  };\n\n  slider.handle = function (_) {\n    if (!arguments.length) return handle;\n    handle = _;\n    return slider;\n  };\n\n  slider.displayValue = function (_) {\n    if (!arguments.length) return displayValue;\n    displayValue = _;\n    return slider;\n  };\n\n  slider.fill = function (_) {\n    if (!arguments.length) return fill;\n    fill = _;\n    return slider;\n  };\n\n  slider.on = function () {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? slider : value;\n  };\n\n  return slider;\n}\n\nexport function sliderHorizontal(scale) {\n  return slider(bottom, scale);\n}\nexport function sliderVertical(scale) {\n  return slider(left, scale);\n}\nexport function sliderTop(scale) {\n  return slider(top, scale);\n}\nexport function sliderRight(scale) {\n  return slider(right, scale);\n}\nexport function sliderBottom(scale) {\n  return slider(bottom, scale);\n}\nexport function sliderLeft(scale) {\n  return slider(left, scale);\n}","map":{"version":3,"sources":["/Users/rachel/node_modules/d3-simple-slider/src/slider.js"],"names":["min","max","scan","axisTop","axisRight","axisBottom","axisLeft","dispatch","drag","easeQuadOut","scaleLinear","scaleTime","event","select","UPDATE_DURATION","SLIDER_END_PADDING","KEYBOARD_NUMBER_STEPS","top","right","bottom","left","translateX","x","translateY","y","slider","orientation","scale","value","defaultValue","domain","width","height","displayValue","handle","step","tickValues","marks","tickFormat","ticks","displayFormat","fill","listeners","selection","identityClamped","handleIndex","k","j","transformAlong","transformAcross","axisFunction","handleSelection","fillSelection","textSelection","range","clamp","context","Date","map","d","axis","selectAll","data","enter","append","attr","sliderSelection","sliderEnter","call","on","dragstarted","dragged","dragended","length","merge","handleEnter","i","change","newValue","adjustedValue","Math","alignedValue","key","preventDefault","text","remove","fadeTickText","computeDragNewValue","pos","invert","classed","abs","updateHandle","updateValue","distances","each","push","index","valueModStep","alignValue","notifyListener","animate","transition","ease","duration","_","arguments","toArray","Array","isArray","sort","a","b","silentValue","default","apply","sliderHorizontal","sliderVertical","sliderTop","sliderRight","sliderBottom","sliderLeft"],"mappings":"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","sourcesContent":["import { min, max, scan } from 'd3-array';\nimport { axisTop, axisRight, axisBottom, axisLeft } from 'd3-axis';\nimport { dispatch } from 'd3-dispatch';\nimport { drag } from 'd3-drag';\nimport { easeQuadOut } from 'd3-ease';\nimport { scaleLinear, scaleTime } from 'd3-scale';\nimport { event, select } from 'd3-selection';\nimport 'd3-transition';\n\nvar UPDATE_DURATION = 200;\nvar SLIDER_END_PADDING = 8;\nvar KEYBOARD_NUMBER_STEPS = 100;\n\nvar top = 1;\nvar right = 2;\nvar bottom = 3;\nvar left = 4;\n\nfunction translateX(x) {\n  return 'translate(' + x + ',0)';\n}\n\nfunction translateY(y) {\n  return 'translate(0,' + y + ')';\n}\n\nfunction slider(orientation, scale) {\n  scale = typeof scale !== 'undefined' ? scale : null;\n\n  var value = [0];\n  var defaultValue = [0];\n  var domain = [0, 10];\n  var width = 100;\n  var height = 100;\n  var displayValue = true;\n  var handle = 'M-5.5,-5.5v10l6,5.5l6,-5.5v-10z';\n  var step = null;\n  var tickValues = null;\n  var marks = null;\n  var tickFormat = null;\n  var ticks = null;\n  var displayFormat = null;\n  var fill = null;\n\n  var listeners = dispatch('onchange', 'start', 'end', 'drag');\n\n  var selection = null;\n  var identityClamped = null;\n  var handleIndex = null;\n\n  var k = orientation === top || orientation === left ? -1 : 1;\n  var j = orientation === left || orientation === right ? -1 : 1;\n  var x = orientation === left || orientation === right ? 'y' : 'x';\n  var y = orientation === left || orientation === right ? 'x' : 'y';\n\n  var transformAlong =\n    orientation === top || orientation === bottom ? translateX : translateY;\n\n  var transformAcross =\n    orientation === top || orientation === bottom ? translateY : translateX;\n\n  var axisFunction = null;\n\n  switch (orientation) {\n    case top:\n      axisFunction = axisTop;\n      break;\n    case right:\n      axisFunction = axisRight;\n      break;\n    case bottom:\n      axisFunction = axisBottom;\n      break;\n    case left:\n      axisFunction = axisLeft;\n      break;\n  }\n\n  var handleSelection = null;\n  var fillSelection = null;\n  var textSelection = null;\n\n  if (scale) {\n    domain = [min(scale.domain()), max(scale.domain())];\n\n    if (orientation === top || orientation === bottom) {\n      width = max(scale.range()) - min(scale.range());\n    } else {\n      height = max(scale.range()) - min(scale.range());\n    }\n\n    scale = scale.clamp(true);\n  }\n\n  function slider(context) {\n    selection = context.selection ? context.selection() : context;\n\n    if (scale) {\n      scale = scale.range([\n        min(scale.range()),\n        min(scale.range()) +\n          (orientation === top || orientation === bottom ? width : height),\n      ]);\n    } else {\n      scale = domain[0] instanceof Date ? scaleTime() : scaleLinear();\n\n      scale = scale\n        .domain(domain)\n        .range(\n          orientation === top || orientation === bottom\n            ? [0, width]\n            : [height, 0]\n        )\n        .clamp(true);\n    }\n\n    identityClamped = scaleLinear()\n      .range(scale.range())\n      .domain(scale.range())\n      .clamp(true);\n\n    // Ensure value is valid\n    value = value.map(function(d) {\n      return scaleLinear()\n        .range(domain)\n        .domain(domain)\n        .clamp(true)(d);\n    });\n\n    tickFormat = tickFormat || scale.tickFormat();\n    displayFormat = displayFormat || tickFormat || scale.tickFormat();\n\n    var axis = selection.selectAll('.axis').data([null]);\n\n    axis\n      .enter()\n      .append('g')\n      .attr('transform', transformAcross(k * 7))\n      .attr('class', 'axis');\n\n    var sliderSelection = selection.selectAll('.slider').data([null]);\n\n    var sliderEnter = sliderSelection\n      .enter()\n      .append('g')\n      .attr('class', 'slider')\n      .attr(\n        'cursor',\n        orientation === top || orientation === bottom\n          ? 'ew-resize'\n          : 'ns-resize'\n      )\n      .call(\n        drag()\n          .on('start', dragstarted)\n          .on('drag', dragged)\n          .on('end', dragended)\n      );\n\n    sliderEnter\n      .append('line')\n      .attr('class', 'track')\n      .attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING)\n      .attr('stroke', '#bbb')\n      .attr('stroke-width', 6)\n      .attr('stroke-linecap', 'round');\n\n    sliderEnter\n      .append('line')\n      .attr('class', 'track-inset')\n      .attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING)\n      .attr('stroke', '#eee')\n      .attr('stroke-width', 4)\n      .attr('stroke-linecap', 'round');\n\n    if (fill) {\n      sliderEnter\n        .append('line')\n        .attr('class', 'track-fill')\n        .attr(\n          x + '1',\n          value.length === 1\n            ? scale.range()[0] - j * SLIDER_END_PADDING\n            : scale(value[0])\n        )\n        .attr('stroke', fill)\n        .attr('stroke-width', 4)\n        .attr('stroke-linecap', 'round');\n    }\n\n    sliderEnter\n      .append('line')\n      .attr('class', 'track-overlay')\n      .attr(x + '1', scale.range()[0] - j * SLIDER_END_PADDING)\n      .attr('stroke', 'transparent')\n      .attr('stroke-width', 40)\n      .attr('stroke-linecap', 'round')\n      .merge(sliderSelection.select('.track-overlay'));\n\n    handleSelection = sliderEnter.selectAll('.parameter-value').data(value);\n\n    var handleEnter = handleSelection\n      .enter()\n      .append('g')\n      .attr('class', 'parameter-value')\n      .attr('transform', function(d) {\n        return transformAlong(scale(d));\n      })\n      .attr('font-family', 'sans-serif')\n      .attr(\n        'text-anchor',\n        orientation === right\n          ? 'start'\n          : orientation === left\n          ? 'end'\n          : 'middle'\n      );\n\n    handleEnter\n      .append('path')\n      .attr('transform', 'rotate(' + (orientation + 1) * 90 + ')')\n      .attr('d', handle)\n      .attr('class', 'handle')\n      .attr('aria-label', 'handle')\n      .attr('aria-valuemax', domain[1])\n      .attr('aria-valuemin', domain[0])\n      .attr('aria-valuenow', value)\n      .attr(\n        'aria-orientation',\n        orientation === left || orientation === right\n          ? 'vertical'\n          : 'horizontal'\n      )\n      .attr('focusable', 'true')\n      .attr('tabindex', 0)\n      .attr('fill', 'white')\n      .attr('stroke', '#777')\n      .on('keydown', function(d, i) {\n        var change = step || (domain[1] - domain[0]) / KEYBOARD_NUMBER_STEPS;\n\n        // TODO: Don't need to loop over value because we know which element needs to change\n        function newValue(adjustedValue) {\n          return value.map(function(d, j) {\n            if (value.length === 2) {\n              return j === i\n                ? i === 0\n                  ? Math.min(adjustedValue, alignedValue(value[1]))\n                  : Math.max(adjustedValue, alignedValue(value[0]))\n                : d;\n            } else {\n              return j === i ? adjustedValue : d;\n            }\n          });\n        }\n\n        switch (event.key) {\n          case 'ArrowLeft':\n          case 'ArrowDown':\n            slider.value(newValue(+value[i] - change));\n            event.preventDefault();\n            break;\n          case 'PageDown':\n            slider.value(newValue(+value[i] - 2 * change));\n            event.preventDefault();\n            break;\n          case 'ArrowRight':\n          case 'ArrowUp':\n            slider.value(newValue(+value[i] + change));\n            event.preventDefault();\n            break;\n          case 'PageUp':\n            slider.value(newValue(+value[i] + 2 * change));\n            event.preventDefault();\n            break;\n          case 'Home':\n            slider.value(newValue(domain[0]));\n            event.preventDefault();\n            break;\n          case 'End':\n            slider.value(newValue(domain[1]));\n            event.preventDefault();\n            break;\n        }\n      });\n\n    if (displayValue && value.length === 1) {\n      handleEnter\n        .append('text')\n        .attr('font-size', 10) // TODO: Remove coupling to font-size in d3-axis\n        .attr(y, k * 27)\n        .attr(\n          'dy',\n          orientation === top\n            ? '0em'\n            : orientation === bottom\n            ? '.71em'\n            : '.32em'\n        )\n        .text(tickFormat(value[0]));\n    }\n\n    context\n      .select('.track')\n      .attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n\n    context\n      .select('.track-inset')\n      .attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n\n    if (fill) {\n      context\n        .select('.track-fill')\n        .attr(x + '2', value.length === 1 ? scale(value[0]) : scale(value[1]));\n    }\n\n    context\n      .select('.track-overlay')\n      .attr(x + '2', scale.range()[1] + j * SLIDER_END_PADDING);\n\n    context.select('.axis').call(\n      axisFunction(scale)\n        .tickFormat(tickFormat)\n        .ticks(ticks)\n        .tickValues(tickValues)\n    );\n\n    // https://bl.ocks.org/mbostock/4323929\n    selection\n      .select('.axis')\n      .select('.domain')\n      .remove();\n\n    context.select('.axis').attr('transform', transformAcross(k * 7));\n\n    context\n      .selectAll('.axis text')\n      .attr('fill', '#aaa')\n      .attr(y, k * 20)\n      .attr(\n        'dy',\n        orientation === top ? '0em' : orientation === bottom ? '.71em' : '.32em'\n      )\n      .attr(\n        'text-anchor',\n        orientation === right\n          ? 'start'\n          : orientation === left\n          ? 'end'\n          : 'middle'\n      );\n\n    context.selectAll('.axis line').attr('stroke', '#aaa');\n\n    context.selectAll('.parameter-value').attr('transform', function(d) {\n      return transformAlong(scale(d));\n    });\n\n    fadeTickText();\n\n    function computeDragNewValue(pos) {\n      var adjustedValue = alignedValue(scale.invert(pos));\n      return value.map(function(d, i) {\n        if (value.length === 2) {\n          return i === handleIndex\n            ? handleIndex === 0\n              ? Math.min(adjustedValue, alignedValue(value[1]))\n              : Math.max(adjustedValue, alignedValue(value[0]))\n            : d;\n        } else {\n          return i === handleIndex ? adjustedValue : d;\n        }\n      });\n    }\n\n    function dragstarted() {\n      select(this).classed('active', true);\n\n      var pos = identityClamped(\n        orientation === bottom || orientation === top ? event.x : event.y\n      );\n\n      // Handle cases where both handles are at the same end of the slider\n      if (value[0] === domain[0] && value[1] === domain[0]) {\n        handleIndex = 1;\n      } else if (value[0] === domain[1] && value[1] === domain[1]) {\n        handleIndex = 0;\n      } else {\n        handleIndex = scan(\n          value.map(function(d) {\n            return Math.abs(d - alignedValue(scale.invert(pos)));\n          })\n        );\n      }\n\n      var newValue = value.map(function(d, i) {\n        return i === handleIndex ? alignedValue(scale.invert(pos)) : d;\n      });\n\n      updateHandle(newValue);\n      listeners.call(\n        'start',\n        sliderSelection,\n        newValue.length === 1 ? newValue[0] : newValue\n      );\n      updateValue(newValue, true);\n    }\n\n    function dragged() {\n      var pos = identityClamped(\n        orientation === bottom || orientation === top ? event.x : event.y\n      );\n      var newValue = computeDragNewValue(pos);\n\n      updateHandle(newValue);\n      listeners.call(\n        'drag',\n        sliderSelection,\n        newValue.length === 1 ? newValue[0] : newValue\n      );\n      updateValue(newValue, true);\n    }\n\n    function dragended() {\n      select(this).classed('active', false);\n\n      var pos = identityClamped(\n        orientation === bottom || orientation === top ? event.x : event.y\n      );\n      var newValue = computeDragNewValue(pos);\n\n      updateHandle(newValue);\n      listeners.call(\n        'end',\n        sliderSelection,\n        newValue.length === 1 ? newValue[0] : newValue\n      );\n      updateValue(newValue, true);\n\n      handleIndex = null;\n    }\n\n    textSelection = selection.select('.parameter-value text');\n    fillSelection = selection.select('.track-fill');\n  }\n\n  function fadeTickText() {\n    if (selection) {\n      if (displayValue && value.length === 1) {\n        var distances = [];\n\n        selection.selectAll('.axis .tick').each(function(d) {\n          distances.push(Math.abs(d - value[0]));\n        });\n\n        var index = scan(distances);\n\n        selection.selectAll('.axis .tick text').attr('opacity', function(d, i) {\n          return i === index ? 0 : 1;\n        });\n      }\n    }\n  }\n\n  function alignedValue(newValue) {\n    if (step) {\n      var valueModStep = (newValue - domain[0]) % step;\n      var alignValue = newValue - valueModStep;\n\n      if (valueModStep * 2 > step) {\n        alignValue += step;\n      }\n\n      return newValue instanceof Date ? new Date(alignValue) : alignValue;\n    }\n\n    if (marks) {\n      var index = scan(\n        marks.map(function(d) {\n          return Math.abs(newValue - d);\n        })\n      );\n\n      return marks[index];\n    }\n\n    return newValue;\n  }\n\n  function updateValue(newValue, notifyListener) {\n    if (\n      value[0] !== newValue[0] ||\n      (value.length > 1 && value[1] !== newValue[1])\n    ) {\n      value = newValue;\n\n      if (notifyListener) {\n        listeners.call(\n          'onchange',\n          slider,\n          newValue.length === 1 ? newValue[0] : newValue\n        );\n      }\n\n      fadeTickText();\n    }\n  }\n\n  function updateHandle(newValue, animate) {\n    if (selection) {\n      animate = typeof animate !== 'undefined' ? animate : false;\n\n      if (animate) {\n        selection\n          .selectAll('.parameter-value')\n          .data(newValue)\n          .transition()\n          .ease(easeQuadOut)\n          .duration(UPDATE_DURATION)\n          .attr('transform', function(d) {\n            return transformAlong(scale(d));\n          })\n          .select('.handle')\n          .attr('aria-valuenow', function(d) {\n            return d;\n          });\n\n        if (fill) {\n          fillSelection\n            .transition()\n            .ease(easeQuadOut)\n            .duration(UPDATE_DURATION)\n            .attr(\n              x + '1',\n              value.length === 1\n                ? scale.range()[0] - k * SLIDER_END_PADDING\n                : scale(newValue[0])\n            )\n            .attr(\n              x + '2',\n              value.length === 1 ? scale(newValue[0]) : scale(newValue[1])\n            );\n        }\n      } else {\n        selection\n          .selectAll('.parameter-value')\n          .data(newValue)\n          .attr('transform', function(d) {\n            return transformAlong(scale(d));\n          })\n          .select('.handle')\n          .attr('aria-valuenow', function(d) {\n            return d;\n          });\n\n        if (fill) {\n          fillSelection\n            .attr(\n              x + '1',\n              value.length === 1\n                ? scale.range()[0] - k * SLIDER_END_PADDING\n                : scale(newValue[0])\n            )\n            .attr(\n              x + '2',\n              value.length === 1 ? scale(newValue[0]) : scale(newValue[1])\n            );\n        }\n      }\n\n      if (displayValue) {\n        textSelection.text(displayFormat(newValue[0]));\n      }\n    }\n  }\n\n  slider.min = function(_) {\n    if (!arguments.length) return domain[0];\n    domain[0] = _;\n    return slider;\n  };\n\n  slider.max = function(_) {\n    if (!arguments.length) return domain[1];\n    domain[1] = _;\n    return slider;\n  };\n\n  slider.domain = function(_) {\n    if (!arguments.length) return domain;\n    domain = _;\n    return slider;\n  };\n\n  slider.width = function(_) {\n    if (!arguments.length) return width;\n    width = _;\n    return slider;\n  };\n\n  slider.height = function(_) {\n    if (!arguments.length) return height;\n    height = _;\n    return slider;\n  };\n\n  slider.tickFormat = function(_) {\n    if (!arguments.length) return tickFormat;\n    tickFormat = _;\n    return slider;\n  };\n\n  slider.displayFormat = function(_) {\n    if (!arguments.length) return displayFormat;\n    displayFormat = _;\n    return slider;\n  };\n\n  slider.ticks = function(_) {\n    if (!arguments.length) return ticks;\n\n    ticks = _;\n    return slider;\n  };\n\n  slider.value = function(_) {\n    if (!arguments.length) {\n      if (value.length === 1) {\n        return value[0];\n      }\n\n      return value;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n    toArray.sort(function(a, b) {\n      return a - b;\n    });\n    var pos = toArray.map(scale).map(identityClamped);\n    var newValue = pos.map(scale.invert).map(alignedValue);\n\n    updateHandle(newValue, true);\n    updateValue(newValue, true);\n\n    return slider;\n  };\n\n  slider.silentValue = function(_) {\n    if (!arguments.length) {\n      if (value.length === 1) {\n        return value[0];\n      }\n\n      return value;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n    toArray.sort(function(a, b) {\n      return a - b;\n    });\n    var pos = toArray.map(scale).map(identityClamped);\n    var newValue = pos.map(scale.invert).map(alignedValue);\n\n    updateHandle(newValue, false);\n    updateValue(newValue, false);\n\n    return slider;\n  };\n\n  slider.default = function(_) {\n    if (!arguments.length) {\n      if (defaultValue.length === 1) {\n        return defaultValue[0];\n      }\n\n      return defaultValue;\n    }\n\n    var toArray = Array.isArray(_) ? _ : [_];\n\n    toArray.sort(function(a, b) {\n      return a - b;\n    });\n\n    defaultValue = toArray;\n    value = toArray;\n    return slider;\n  };\n\n  slider.step = function(_) {\n    if (!arguments.length) return step;\n    step = _;\n    return slider;\n  };\n\n  slider.tickValues = function(_) {\n    if (!arguments.length) return tickValues;\n    tickValues = _;\n    return slider;\n  };\n\n  slider.marks = function(_) {\n    if (!arguments.length) return marks;\n    marks = _;\n    return slider;\n  };\n\n  slider.handle = function(_) {\n    if (!arguments.length) return handle;\n    handle = _;\n    return slider;\n  };\n\n  slider.displayValue = function(_) {\n    if (!arguments.length) return displayValue;\n    displayValue = _;\n    return slider;\n  };\n\n  slider.fill = function(_) {\n    if (!arguments.length) return fill;\n    fill = _;\n    return slider;\n  };\n\n  slider.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? slider : value;\n  };\n\n  return slider;\n}\n\nexport function sliderHorizontal(scale) {\n  return slider(bottom, scale);\n}\n\nexport function sliderVertical(scale) {\n  return slider(left, scale);\n}\n\nexport function sliderTop(scale) {\n  return slider(top, scale);\n}\n\nexport function sliderRight(scale) {\n  return slider(right, scale);\n}\n\nexport function sliderBottom(scale) {\n  return slider(bottom, scale);\n}\n\nexport function sliderLeft(scale) {\n  return slider(left, scale);\n}\n"]},"metadata":{},"sourceType":"module"}