{"ast":null,"code":"import _classCallCheck from\"/Users/rachel/Desktop/894-a4/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/rachel/Desktop/894-a4/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/rachel/Desktop/894-a4/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/rachel/Desktop/894-a4/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import*as d3 from\"d3\";var width=960;var height=500;var margin={top:50,right:50,bottom:100,left:50};var LineChart=/*#__PURE__*/function(_Component){_inherits(LineChart,_Component);var _super=_createSuper(LineChart);function LineChart(){_classCallCheck(this,LineChart);return _super.apply(this,arguments);}_createClass(LineChart,[{key:\"componentDidMount\",value:function componentDidMount(){this.drawChart(this.props.data);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.update(this.props.data,this.props.threshold,this.props.selected);}},{key:\"drawChart\",value:function drawChart(data){// ------- scale ---------//\n// let new_data = data.filter(function(d) {return d.date <\nvar startDate=data.date[0],endDate=data.date[data.date.length-1];var maxi=d3.max(data.series,function(s){return d3.max(s.positive.map(function(d){if(d!==\"undefined\"){return d;}else{return-1;}}));});console.log(d3.max(data.series[0].positive));console.log(maxi);var xScale=d3.scaleTime().domain([startDate,endDate]).range([margin.left,width-margin.right]);var yScale=d3.scaleLinear()// d3.max(data, d => d.positive)\n.domain([0,maxi]).nice().range([height-margin.bottom,margin.top]);// --------- axis --------//\nvar xAxis=d3.axisBottom().ticks(d3.timeDay.every(1)).tickFormat(d3.timeFormat('%m/%d')).scale(xScale);var yAxis=d3.axisLeft().ticks(10).scale(yScale);// ------- draw --------//\nthis.svg=d3.select(this.refs.chart).append(\"svg\").attr('width',width).attr('height',height);this.svg.append(\"g\").attr(\"transform\",\"translate(0,\".concat(height-margin.bottom,\")\")).call(xAxis);this.svg.append(\"g\").attr(\"transform\",\"translate(\".concat(margin.left,\",0)\")).call(yAxis);this.chart=this.svg.append(\"g\");}},{key:\"update\",value:function update(data,threshold,selected){// let new_data = data.filter(function(d) {return d.date <\nconsole.log(selected);var index=data.date.findIndex(function(d){return d.getDate()===threshold.getDate();});var new_data=data.series.filter(function(d){return selected.includes(d.name);});console.log(new_data.length);new_data=new_data.map(function(d){return{name:d.name,positive:d.positive.slice(0,index)};});console.log(new_data);var startDate=data.date[0],endDate=data.date[data.date.length-1];var maxi=d3.max(data.series,function(s){return d3.max(s.positive.map(function(d){if(d!==\"undefined\"){return d;}else{return-1;}}));});var xScale=d3.scaleTime().domain([startDate,endDate]).range([margin.left,width-margin.right]);var yScale=d3.scaleLinear().domain([0,maxi]).nice().range([height-margin.bottom,margin.top]);var color=d3.scaleOrdinal(d3.schemeTableau10).domain(new_data.map(function(d){return d.name;}));var line=d3.line().defined(function(d){return d!==\"undefined\";}).x(function(d,i){return xScale(data.date[i]);}).y(function(d){return yScale(d);});this.chart.selectAll(\"path\").data(new_data).join(\"path\").attr(\"stroke-width\",2).attr(\"stroke\",function(d){return color(d.name);}).attr(\"fill\",\"none\").attr(\"d\",function(d){return line(d.positive);});this.chart.selectAll(\"text\").data(new_data).join(\"text\").attr(\"x\",xScale(endDate))// space legend\n.attr(\"y\",function(d,i){return margin.top+i*15;}).attr(\"class\",\"legend\")// style the legend\n.style(\"fill\",function(d){return color(d.name);}).text(function(d){return d.name;});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{ref:\"chart\"});}}]);return LineChart;}(Component);export default LineChart;","map":{"version":3,"sources":["/Users/rachel/Desktop/894-a4/my-app/src/LineChart.js"],"names":["React","Component","d3","width","height","margin","top","right","bottom","left","LineChart","drawChart","props","data","update","threshold","selected","startDate","date","endDate","length","maxi","max","series","s","positive","map","d","console","log","xScale","scaleTime","domain","range","yScale","scaleLinear","nice","xAxis","axisBottom","ticks","timeDay","every","tickFormat","timeFormat","scale","yAxis","axisLeft","svg","select","refs","chart","append","attr","call","index","findIndex","getDate","new_data","filter","includes","name","slice","color","scaleOrdinal","schemeTableau10","line","defined","x","i","y","selectAll","join","style","text"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport * as d3 from \"d3\"\n\nconst width = 960;\nconst height = 500;\nconst margin = {top: 50, right: 50, bottom: 100, left:50};\n\nclass LineChart extends Component {\n\n  componentDidMount() {\n    this.drawChart(this.props.data)\n  }\n\n  componentDidUpdate(){\n    this.update(this.props.data, this.props.threshold, this.props.selected)\n  }\n\n  drawChart(data) {\n    // ------- scale ---------//\n    // let new_data = data.filter(function(d) {return d.date <\n    var startDate = data.date[0],\n        endDate = data.date[data.date.length-1];\n\n    var maxi = d3.max(data.series, s => d3.max(s.positive.map(\n      function(d) {\n            if (d !== \"undefined\") {return d}\n            else { return -1}\n      })))\n    console.log(d3.max(data.series[0].positive))\n    console.log(maxi)\n\n    var xScale = d3.scaleTime()\n      .domain([startDate, endDate])\n      .range([margin.left, width - margin.right]);\n\n    var yScale = d3.scaleLinear()\n      // d3.max(data, d => d.positive)\n      .domain ([0, maxi]).nice()\n      .range([height - margin.bottom, margin.top])\n\n    // --------- axis --------//\n    const xAxis = d3.axisBottom()\n      .ticks(d3.timeDay.every(1))\n      .tickFormat(d3.timeFormat('%m/%d'))\n      .scale(xScale);\n\n    const yAxis = d3.axisLeft()\n      .ticks(10)\n      .scale(yScale);\n\n    // ------- draw --------//\n    this.svg = d3.select(this.refs.chart)\n      .append(\"svg\")\n      .attr('width', width )\n      .attr('height', height )\n\n    this.svg.append(\"g\")\n      .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n      .call(xAxis);\n\n    this.svg.append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},0)`)\n      .call(yAxis);\n\n    this.chart = this.svg.append(\"g\")\n\n\n    }\n\n    update(data, threshold, selected){\n      // let new_data = data.filter(function(d) {return d.date <\n      console.log(selected)\n      var index = data.date.findIndex(function(d) {return d.getDate() === threshold.getDate()});\n      var new_data = data.series.filter(d => {return selected.includes(d.name)})\n      console.log(new_data.length)\n\n      new_data = new_data.map(d => { return {\n        name: d.name,\n        positive: d.positive.slice(0,index)\n        }\n      })\n      console.log(new_data)\n\n      var startDate = data.date[0],\n          endDate = data.date[data.date.length-1];\n\n      var maxi = d3.max(data.series, s => d3.max(s.positive.map(\n        function(d) {\n              if (d !== \"undefined\") {return d}\n              else { return -1}\n        })))\n\n      var xScale = d3.scaleTime()\n        .domain([startDate, endDate])\n        .range([margin.left, width - margin.right]);\n\n      var yScale = d3.scaleLinear()\n        .domain ([0, maxi]).nice()\n        .range([height - margin.bottom, margin.top])\n\n\n      var color = d3.scaleOrdinal(d3.schemeTableau10).domain(new_data.map(d => d.name));\n\n      var line = d3.line()\n        .defined(d => d !== \"undefined\")\n        .x((d,i) => xScale(data.date[i]))\n        .y(d => yScale(d))\n\n      this.chart.selectAll(\"path\")\n        .data(new_data)\n          .join(\"path\")\n            .attr(\"stroke-width\", 2)\n            .attr(\"stroke\", (d)=> color(d.name))\n            .attr(\"fill\", \"none\")\n            .attr(\"d\", d=>line(d.positive))\n\n      this.chart.selectAll(\"text\")\n        .data(new_data)\n          .join(\"text\")\n          .attr(\"x\", xScale(endDate))  // space legend\n          .attr(\"y\", (d,i) => margin.top + i*15)\n          .attr(\"class\", \"legend\")    // style the legend\n          .style(\"fill\", (d) => color(d.name))\n          .text(d => d.name);\n        }\n\n\n  render() {return <div ref=\"chart\"></div>}\n}\n\n\nexport default LineChart;\n"]},"metadata":{},"sourceType":"module"}